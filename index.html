<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Deal Qualification Tool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg-body: #f5f5f7;
      --bg-surface: #ffffff;
      --bg-subtle: #f9fafb;
      --border-subtle: #e5e7eb;
      --border-strong: #d1d5db;
      --text-main: #111827;
      --text-muted: #6b7280;
      --accent: #4f46e5;
      --accent-soft: rgba(79, 70, 229, 0.08);
      --danger: #dc2626;
      --radius-lg: 14px;
      --radius-md: 10px;
      --radius-sm: 6px;
      --shadow-soft: 0 18px 45px rgba(15, 23, 42, 0.10);
      --shadow-card: 0 10px 25px rgba(15, 23, 42, 0.06);
      --font-sans: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }

    * {
      box-sizing: border-box;
    }

    html,
    body {
      margin: 0;
      padding: 0;
      font-family: var(--font-sans);
      background: radial-gradient(circle at top left, #f9fafb, #eef2ff);
      color: var(--text-main);
    }

    body {
      min-height: 100vh;
    }

    .app-shell {
      max-width: 1120px;
      margin: 24px auto 40px auto;
      padding: 0 16px;
    }

    .app-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
      gap: 12px;
    }

    .app-title {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo-pill {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background: linear-gradient(135deg, #111827, #4b5563);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #f9fafb;
      font-size: 16px;
      font-weight: 600;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.35);
    }

    .app-title h1 {
      margin: 0;
      font-size: 20px;
      letter-spacing: -0.02em;
    }

    .app-title span {
      display: block;
      font-size: 12px;
      color: var(--text-muted);
    }

    .header-meta {
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .badge {
      border-radius: 999px;
      font-size: 11px;
      padding: 4px 10px;
      border: 1px solid rgba(17, 24, 39, 0.08);
      background: rgba(255, 255, 255, 0.8);
      color: var(--text-muted);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      backdrop-filter: blur(12px);
    }

    .badge-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.18);
    }

    .main-card {
      background: rgba(255, 255, 255, 0.96);
      border-radius: 20px;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(148, 163, 184, 0.4);
      padding: 16px 16px 20px 16px;
      backdrop-filter: blur(18px);
    }

    .tabs {
      display: flex;
      gap: 4px;
      padding: 4px;
      border-radius: 999px;
      background: #f3f4f6;
      width: fit-content;
    }

    .tab-button {
      border-radius: 999px;
      border: none;
      padding: 6px 16px;
      font-size: 13px;
      background: transparent;
      color: var(--text-muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.16s ease;
    }

    .tab-button span.icon {
      font-size: 14px;
    }

    .tab-button.active {
      background: #ffffff;
      color: var(--text-main);
      box-shadow: 0 4px 14px rgba(15, 23, 42, 0.13);
    }

    .tab-button:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    .tab-bar-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      flex-wrap: wrap;
      gap: 8px;
    }

    .start-area {
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--text-muted);
      font-size: 13px;
    }

    .btn-primary,
    .btn-secondary,
    .btn-ghost,
    .btn-danger {
      border-radius: 999px;
      font-size: 13px;
      padding: 7px 14px;
      border: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: all 0.16s ease;
      white-space: nowrap;
    }

    .btn-primary {
      background: #111827;
      color: #f9fafb;
      box-shadow: 0 8px 18px rgba(15, 23, 42, 0.35);
    }

    .btn-primary:hover {
      background: #020617;
      transform: translateY(-1px);
      box-shadow: 0 12px 24px rgba(15, 23, 42, 0.4);
    }

    .btn-primary:disabled {
      opacity: 0.4;
      cursor: default;
      transform: none;
      box-shadow: none;
    }

    .btn-secondary {
      background: #e5e7eb;
      color: #111827;
    }

    .btn-secondary:hover {
      background: #d1d5db;
    }

    .btn-ghost {
      background: transparent;
      color: var(--text-muted);
      padding-inline: 8px;
    }

    .btn-danger {
      background: #fee2e2;
      color: #b91c1c;
    }

    .btn-danger:hover {
      background: #fecaca;
    }

    .content {
      margin-top: 8px;
    }

    .section {
      margin-bottom: 14px;
    }

    .section-card {
      background: var(--bg-subtle);
      border-radius: var(--radius-lg);
      padding: 14px 16px;
      border: 1px solid var(--border-subtle);
      box-shadow: var(--shadow-card);
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      gap: 8px;
    }

    .section-title {
      font-size: 14px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .section-subtitle {
      font-size: 12px;
      color: var(--text-muted);
    }

    .pill-muted {
      font-size: 11px;
      border-radius: 999px;
      padding: 2px 8px;
      background: rgba(15, 23, 42, 0.04);
      color: var(--text-muted);
    }

    .collapse-toggle {
      border-radius: 999px;
      border: none;
      background: transparent;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      color: var(--text-muted);
      cursor: pointer;
      padding: 3px 8px;
    }

    .collapse-toggle:hover {
      background: rgba(15, 23, 42, 0.06);
    }

    .section-body {
      margin-top: 8px;
    }

    .section-body.collapsed {
      display: none;
    }

    /* Deal info form */
    .deal-info-grid {
      display: grid;
      grid-template-columns: 1.2fr 2fr;
      gap: 12px;
      align-items: flex-start;
    }

    .form-field {
      margin-bottom: 8px;
    }

    .form-label {
      font-size: 12px;
      font-weight: 500;
      margin-bottom: 4px;
      display: flex;
      align-items: center;
      gap: 4px;
      color: #374151;
    }

    .required-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--danger);
    }

    input[type="text"],
    textarea,
    input[type="number"],
    select {
      width: 100%;
      border-radius: 10px;
      border: 1px solid var(--border-subtle);
      padding: 7px 9px;
      font-size: 13px;
      background: #ffffff;
      color: var(--text-main);
      transition: border-color 0.15s ease, box-shadow 0.15s ease,
        background-color 0.15s ease;
    }

    input[type="text"]:focus,
    textarea:focus,
    input[type="number"]:focus,
    select:focus {
      outline: none;
      border-color: #6366f1;
      box-shadow: 0 0 0 1px rgba(99, 102, 241, 0.3);
      background: #ffffff;
    }

    textarea {
      resize: vertical;
      min-height: 72px;
    }

    .form-footer {
      display: flex;
      justify-content: flex-end;
      margin-top: 6px;
    }

    .error-text {
      font-size: 11px;
      color: var(--danger);
      margin-top: 4px;
    }

    /* Tables */
    .grid-two {
      display: grid;
      grid-template-columns: minmax(0, 2fr) minmax(0, 1.1fr);
      gap: 12px;
    }

    .score-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
    }

    .score-table thead {
      background: #e5e7eb;
    }

    .score-table th,
    .score-table td {
      padding: 6px 8px;
      border-bottom: 1px solid #e5e7eb;
      text-align: left;
      vertical-align: middle;
    }

    .score-table th:first-child,
    .score-table td:first-child {
      border-left: 1px solid #e5e7eb;
    }

    .score-table th:last-child,
    .score-table td:last-child {
      border-right: 1px solid #e5e7eb;
    }

    .score-table th {
      font-weight: 500;
      color: #374151;
    }

    .score-table tbody tr:nth-child(even) {
      background: #f9fafb;
    }

    .score-table caption {
      text-align: left;
      font-size: 12px;
      margin-bottom: 6px;
      color: var(--text-muted);
    }

    .group-row {
      background: #f3f4f6 !important;
      font-weight: 600;
      font-size: 11px;
      color: #111827;
    }

    .info-icon {
      width: 18px;
      height: 18px;
      border-radius: 999px;
      border: 1px solid #d1d5db;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      color: #6b7280;
      cursor: pointer;
      background: #ffffff;
      position: relative;
    }

    .tooltip {
      position: absolute;
      z-index: 30;
      top: 125%;
      left: 50%;
      transform: translateX(-50%);
      min-width: 220px;
      max-width: 260px;
      background: #111827;
      color: #f9fafb;
      border-radius: 10px;
      padding: 8px 10px;
      font-size: 11px;
      box-shadow: 0 12px 30px rgba(15, 23, 42, 0.5);
      display: none;
    }

    .tooltip.visible {
      display: block;
    }

    .tooltip-title {
      font-weight: 600;
      margin-bottom: 4px;
    }

    .tooltip-line {
      margin-bottom: 2px;
      color: #e5e7eb;
    }

    .tooltip-line span {
      font-weight: 500;
    }

    /* Weights */
    .weight-card {
      background: #f9fafb;
      border-radius: 12px;
      padding: 8px 10px;
      border: 1px dashed var(--border-subtle);
      font-size: 12px;
    }

    .weight-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
    }

    .weight-card-title {
      font-weight: 500;
      font-size: 12px;
    }

    .weight-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 4px;
    }

    .weight-row span {
      font-size: 12px;
      color: #374151;
    }

    .weight-input {
      width: 64px;
      text-align: right;
      font-variant-numeric: tabular-nums;
    }

    .weight-sum {
      font-size: 11px;
      color: var(--text-muted);
      text-align: right;
      margin-top: 2px;
    }

    .weight-sum.error {
      color: var(--danger);
    }

    .helper-text {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 2px;
    }

    /* Results & summaries */
    .section-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 10px;
      gap: 8px;
      flex-wrap: wrap;
    }

    .result-summary {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 8px;
      margin-top: 8px;
    }

    .result-pill {
      background: #111827;
      color: #f9fafb;
      border-radius: 999px;
      padding: 6px 12px;
      font-size: 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 6px;
    }

    .result-label {
      font-size: 11px;
      color: #d1d5db;
    }

    .risk-card {
      margin-top: 8px;
      background: #111827;
      color: #f9fafb;
      border-radius: 14px;
      padding: 8px 10px;
      font-size: 12px;
    }

    .risk-card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 4px;
      gap: 6px;
    }

    .risk-card-title {
      font-weight: 500;
      font-size: 12px;
    }

    .risk-chip {
      font-size: 11px;
      border-radius: 999px;
      padding: 2px 8px;
      background: rgba(248, 250, 252, 0.08);
      color: #e5e7eb;
    }

    .risk-list {
      margin: 0;
      padding-left: 16px;
    }

    .risk-list li {
      margin-bottom: 2px;
    }

    /* Summary bars */
    .summary-bar {
      padding: 6px 10px;
      border-radius: 999px;
      background: #eef2ff;
      color: #111827;
      font-size: 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 6px;
      margin-bottom: 6px;
    }

    .summary-bar span.label {
      font-weight: 500;
    }

    .summary-bar small {
      color: #4b5563;
      font-size: 11px;
    }

    /* Modal */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.45);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 50;
    }

    .modal-backdrop.visible {
      display: flex;
    }

    .modal {
      background: #111827;
      color: #f9fafb;
      border-radius: 18px;
      padding: 14px 16px;
      width: min(380px, 90vw);
      box-shadow: 0 24px 60px rgba(0, 0, 0, 0.75);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
    }

    .modal-title {
      font-size: 14px;
      font-weight: 600;
    }

    .modal-body {
      font-size: 13px;
      color: #e5e7eb;
    }

    .modal-sub {
      font-size: 11px;
      color: #9ca3af;
      margin-top: 4px;
    }

    /* Dashboard */
    .dashboard-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.4fr) minmax(0, 1.1fr);
      gap: 12px;
    }

    .metrics-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 8px;
      margin-bottom: 8px;
    }

    .metric-card {
      background: #f9fafb;
      border-radius: 12px;
      padding: 8px 10px;
      border: 1px solid var(--border-subtle);
      font-size: 12px;
    }

    .metric-label {
      font-size: 11px;
      color: var(--text-muted);
      margin-bottom: 2px;
    }

    .metric-value {
      font-size: 18px;
      font-weight: 600;
      letter-spacing: -0.02em;
    }

    .metric-sub {
      font-size: 11px;
      color: #4b5563;
      margin-top: 2px;
    }

    .quadrant-card {
      background: #f9fafb;
      border-radius: 14px;
      padding: 8px;
      border: 1px solid var(--border-subtle);
    }

    .quadrant-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 6px;
      font-size: 12px;
    }

    canvas#quadrantCanvas {
      width: 100%;
      max-width: 420px;
      height: 260px;
      border-radius: 12px;
      background: #f9fafb;
      border: 1px solid #e5e7eb;
    }

    .summary-card {
      background: #111827;
      color: #f9fafb;
      border-radius: 14px;
      padding: 10px 12px;
      font-size: 12px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      min-height: 120px;
    }

    .summary-zone {
      font-weight: 600;
      font-size: 13px;
    }

    .summary-body {
      color: #e5e7eb;
    }

    .summary-actions {
      font-size: 11px;
      color: #cbd5f5;
    }

    /* Admin */
    .admin-list {
      margin-top: 8px;
      border-radius: 12px;
      border: 1px solid var(--border-subtle);
      overflow: hidden;
    }

    .admin-row {
      padding: 8px 10px;
      display: grid;
      grid-template-columns: minmax(0, 2fr) 1.1fr auto;
      gap: 8px;
      align-items: center;
      font-size: 12px;
      background: #ffffff;
    }

    .admin-row:nth-child(even) {
      background: #f9fafb;
    }

    .admin-main {
      min-width: 0;
    }

    .admin-name {
      font-weight: 500;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .admin-desc {
      font-size: 11px;
      color: var(--text-muted);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      margin-top: 2px;
    }

    .admin-date {
      font-size: 11px;
      color: #4b5563;
    }

    .admin-actions {
      display: flex;
      gap: 6px;
      justify-content: flex-end;
    }

    .admin-empty {
      font-size: 12px;
      color: var(--text-muted);
      padding: 10px;
      text-align: center;
      background: #fafafa;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .main-card {
        padding: 12px 12px 16px 12px;
      }

      .tab-bar-row {
        flex-direction: column;
        align-items: flex-start;
      }

      .deal-info-grid {
        grid-template-columns: 1fr;
      }

      .grid-two {
        grid-template-columns: 1fr;
      }

      .dashboard-grid {
        grid-template-columns: 1fr;
      }

      canvas#quadrantCanvas {
        height: 220px;
      }

      .admin-row {
        grid-template-columns: minmax(0, 1.5fr) 1.1fr;
        grid-template-rows: auto auto;
      }

      .admin-actions {
        grid-column: 1 / -1;
        justify-content: flex-start;
      }
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <header class="app-header">
      <div class="app-title">
        <div class="logo-pill">DQ</div>
        <div>
          <h1>Deal Qualification Tool</h1>
          <span>Business Â· Technical Fit ê¸°ë°˜ Deal í‰ê°€</span>
        </div>
      </div>
      <div class="header-meta">
        <div class="badge">
          <span class="badge-dot"></span>
          Live Scoring
        </div>
        <div class="badge">
          <span>Local Storage</span> Â· <span>Single-page</span>
        </div>
      </div>
    </header>

    <main class="main-card">
      <div class="tab-bar-row">
        <div class="tabs" role="tablist">
          <button class="tab-button active" data-tab="qualification" role="tab"
            aria-selected="true">
            <span class="icon">ğŸ“Š</span>
            Deal Qualification
          </button>
          <button class="tab-button" data-tab="admin" role="tab"
            aria-selected="false">
            <span class="icon">ğŸ—‚ï¸</span>
            Admin
          </button>
        </div>
        <div class="start-area">
          <button class="btn-primary" id="startDealButton">
            â–¶ Start
          </button>
          <span>ìƒˆ Dealì„ ì…ë ¥í•˜ê³  ë‹¨ê³„ë³„ë¡œ í‰ê°€ë¥¼ ì§„í–‰í•˜ì„¸ìš”.</span>
        </div>
      </div>

      <div class="content">
        <!-- Deal Qualification Tab -->
        <section class="section" id="tab-qualification">
          <!-- Deal Info -->
          <div class="section-card" id="dealInfoSection" style="display:none;">
            <div class="section-header">
              <div>
                <div class="section-title">
                  <span>Deal ì •ë³´</span>
                  <span class="pill-muted">ê¸°ë³¸ ì •ë³´</span>
                </div>
                <div class="section-subtitle">
                  í‰ê°€ì— ì‚¬ìš©í•  Deal ì´ë¦„ê³¼ ê°„ë‹¨í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”.
                </div>
              </div>
            </div>
            <div class="section-body">
              <div class="deal-info-grid">
                <div>
                  <div class="form-field">
                    <div class="form-label">
                      Deal Name
                      <span class="required-dot"></span>
                    </div>
                    <input type="text" id="dealNameInput"
                      placeholder="ì˜ˆ: ABCì€í–‰ ì°¨ì„¸ëŒ€ ë°ì´í„° í”Œë«í¼" />
                    <div class="error-text" id="dealNameError"
                      style="display:none;">
                      Deal Nameì€ í•„ìˆ˜ì…ë‹ˆë‹¤.
                    </div>
                  </div>
                  <div class="form-field">
                    <div class="form-label">
                      Deal Description
                      <span style="font-size:11px;color:var(--text-muted);">(ì„ íƒ)</span>
                    </div>
                    <textarea id="dealDescriptionInput"
                      placeholder="ê°„ë‹¨í•œ ë°°ê²½, ì£¼ìš” ì´í•´ê´€ê³„ì, ë²”ìœ„ ë“±ì„ ì ì–´ë‘ë©´ ì¢‹ìŠµë‹ˆë‹¤."></textarea>
                  </div>
                </div>
                <div>
                  <div class="helper-text">
                    ì´ ì •ë³´ëŠ” Dashboardì™€ Admin ë¦¬ìŠ¤íŠ¸ì—ì„œ Dealì„ ì‹ë³„í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.
                    <br />ì…ë ¥ í›„ <b>ì™„ë£Œ</b>ë¥¼ ëˆ„ë¥´ë©´ BANT ê¸°ë°˜ Deal Win Score í‰ê°€ë¡œ
                    ì§„í–‰ë©ë‹ˆë‹¤.
                  </div>
                </div>
              </div>
              <div class="form-footer">
                <button class="btn-secondary" id="dealInfoCompleteButton">
                  ì™„ë£Œ â†’ Deal Win Scoreë¡œ ì´ë™
                </button>
              </div>
            </div>
          </div>

          <!-- Collapsed summaries -->
          <div id="dealWinSummaryBar" class="summary-bar" style="display:none;">
            <div>
              <span class="label">Deal Win Score</span>
              <small id="dealWinSummaryText"></small>
            </div>
            <button class="collapse-toggle" data-target="dealWinSectionBody">
              <span>í¼ì¹˜ê¸°/ì ‘ê¸°</span> â–¼
            </button>
          </div>

          <!-- Deal Win Score Section -->
          <div class="section-card" id="dealWinSection" style="display:none;">
            <div class="section-header">
              <div>
                <div class="section-title">
                  <span>BANT ê¸°ë°˜ Deal Win Score</span>
                  <span class="pill-muted">Business Fit</span>
                </div>
                <div class="section-subtitle">
                  Budget / Authority / Need / Timeline ê´€ì ì—ì„œ ìˆ˜ì£¼ ê°€ëŠ¥ì„±ì„
                  ì •ëŸ‰í™”í•©ë‹ˆë‹¤.
                </div>
              </div>
              <button class="collapse-toggle" data-target="dealWinSectionBody">
                <span>ì ‘ê¸°</span> â–²
              </button>
            </div>
            <div class="section-body" id="dealWinSectionBody">
              <div class="grid-two">
                <div>
                  <table class="score-table">
                    <caption>
                      ê° í•­ëª©ì— 1~5 ì ì„ ë¶€ì—¬í•˜ì„¸ìš”. (5ì ì´ ê°€ì¥ ìš°ìˆ˜)
                    </caption>
                    <thead>
                      <tr>
                        <th style="width:40%;">Deal í•­ëª©</th>
                        <th style="width:40%;">ì„¸ë¶€ í•­ëª©</th>
                        <th style="width:10%;">ì ìˆ˜</th>
                        <th style="width:10%;text-align:center;">i</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="group-row">
                        <td>Budget</td>
                        <td colspan="3">ì˜ˆì‚° ë° êµ¬ë§¤ ì¤€ë¹„ë„</td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>ì˜ˆì‚° ë° êµ¬ë§¤ ì¤€ë¹„ë„</td>
                        <td>
                          <select data-dw-score="budgetReadiness">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon"
                            data-tooltip-id="tt-budget-readiness">i
                            <div class="tooltip" id="tt-budget-readiness">
                              <div class="tooltip-title">Budget Â· ì˜ˆì‚° ë° êµ¬ë§¤
                                ì¤€ë¹„ë„</div>
                              <div class="tooltip-line"><span>5ì </span> Â· ì˜ˆì‚° í™•ì •
                                / ìŠ¹ì¸ê¶Œì ë™ì˜ / êµ¬ë§¤ ì ˆì°¨ ëª…í™•</div>
                              <div class="tooltip-line"><span>3ì </span> Â· ì˜ˆì‚°
                                ê°€ëŠ¥í•˜ë‚˜ ìŠ¹ì¸ í•„ìš” / ê°€ê²© ë¯¼ê° / ë¶ˆí™•ì‹¤</div>
                              <div class="tooltip-line"><span>1ì </span> Â· ì˜ˆì‚° ì—†ìŒ
                                / ìŠ¹ì¸ ì˜ì‚¬ ì—†ìŒ</div>
                            </div>
                          </div>
                        </td>
                      </tr>

                      <tr class="group-row">
                        <td>Authority</td>
                        <td colspan="3">ë‚´ë¶€ ì§€ì§€ì íŒŒì›Œ &amp; ì˜ì‚¬ê²°ì •ê¶Œì
                          ì ‘ê·¼ì„±</td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>ë‚´ë¶€ ì§€ì§€ì íŒŒì›Œ</td>
                        <td>
                          <select data-dw-score="authorityChampion">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon"
                            data-tooltip-id="tt-authority-champion">i
                            <div class="tooltip" id="tt-authority-champion">
                              <div class="tooltip-title">Authority Â· ë‚´ë¶€ ì§€ì§€ì
                                íŒŒì›Œ</div>
                              <div class="tooltip-line"><span>5ì </span> Â· íŒŒì›Œ
                                ì±”í”¼ì–¸ / ì ê·¹ì  ì§€ì§€ / ë‚´ë¶€ ì¶”ì§„ ê°•í•¨</div>
                              <div class="tooltip-line"><span>3ì </span> Â· ì‹¤ë¬´
                                ë¦¬ë”ê¸‰ ì±”í”¼ì–¸ / ë‚´ë¶€ ë…¼ì˜ ì£¼ë„ ê°€ëŠ¥</div>
                              <div class="tooltip-line"><span>1ì </span> Â· ì±”í”¼ì–¸
                                ì—†ìŒ / ë‹¨ìˆœ ê´€ì‹¬ì</div>
                            </div>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>ì˜ì‚¬ê²°ì •ê¶Œì ì ‘ê·¼ì„±</td>
                        <td>
                          <select data-dw-score="authorityAccess">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon"
                            data-tooltip-id="tt-authority-access">i
                            <div class="tooltip" id="tt-authority-access">
                              <div class="tooltip-title">Authority Â· ì˜ì‚¬ê²°ì •ê¶Œì
                                ì ‘ê·¼ì„±</div>
                              <div class="tooltip-line"><span>5ì </span> Â· EBì™€
                                ì§ì ‘ ëŒ€í™” / ë‹ˆì¦ˆÂ·ìš°ì„ ìˆœìœ„ í™•ì¸ë¨</div>
                              <div class="tooltip-line"><span>3ì </span> Â· ì˜ì‚¬ê²°ì •
                                êµ¬ì¡° íŒŒì•… / EB ì ‘ì´‰ ê°€ëŠ¥ì„± ì¡´ì¬</div>
                              <div class="tooltip-line"><span>1ì </span> Â· EBê°€
                                ëˆ„êµ¬ì¸ì§€ ëª¨ë¦„ / ì ‘ê·¼ ë¶ˆê°€</div>
                            </div>
                          </div>
                        </td>
                      </tr>

                      <tr class="group-row">
                        <td>Need</td>
                        <td colspan="3">ë¬¸ì œ ì í•©ì„± &amp; ê²½ìŸ êµ¬ë„</td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>ë¬¸ì œ ì í•©ì„±</td>
                        <td>
                          <select data-dw-score="needFit">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon" data-tooltip-id="tt-need-fit">i
                            <div class="tooltip" id="tt-need-fit">
                              <div class="tooltip-title">Need Â· ë¬¸ì œ ì í•©ì„±</div>
                              <div class="tooltip-line"><span>5ì </span> Â· í•µì‹¬
                                Pain / ìš°ë¦¬ ì†”ë£¨ì…˜ì´ ê°€ì¥ ì í•©</div>
                              <div class="tooltip-line"><span>3ì </span> Â· ë¬¸ì œ
                                ëª…í™• / ì†”ë£¨ì…˜ìœ¼ë¡œ í•´ê²° ê°€ëŠ¥</div>
                              <div class="tooltip-line"><span>1ì </span> Â· ë¬¸ì œ
                                ëª¨í˜¸ / ì†”ë£¨ì…˜ê³¼ ì—°ê²° ì•½í•¨</div>
                            </div>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>ê²½ìŸ êµ¬ë„</td>
                        <td>
                          <select data-dw-score="needCompetition">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon"
                            data-tooltip-id="tt-need-competition">i
                            <div class="tooltip" id="tt-need-competition">
                              <div class="tooltip-title">Need Â· ê²½ìŸ êµ¬ë„</div>
                              <div class="tooltip-line"><span>5ì </span> Â· ì‚¬ì‹¤ìƒ
                                ìš°ë¦¬ ì„ íƒ / PoC ì‹œ í™•ì • ìˆ˜ì¤€</div>
                              <div class="tooltip-line"><span>3ì </span> Â·
                                ë¹„ìŠ·ë¹„ìŠ· / ë¹„êµ ì´ˆê¸°</div>
                              <div class="tooltip-line"><span>1ì </span> Â·
                                ê²½ìŸì‚¬ ìš°ìœ„ / ê³ ê° ì„ í˜¸ë„ ë‚®ìŒ</div>
                            </div>
                          </div>
                        </td>
                      </tr>

                      <tr class="group-row">
                        <td>Timeline</td>
                        <td colspan="3">ì‹œê¸‰ì„±/íƒ€ì´ë° &amp; ë„ì… ìš©ì´ì„±</td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>ì‹œê¸‰ì„±/íƒ€ì´ë°</td>
                        <td>
                          <select data-dw-score="timelineUrgency">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon"
                            data-tooltip-id="tt-timeline-urgency">i
                            <div class="tooltip" id="tt-timeline-urgency">
                              <div class="tooltip-title">Timeline Â·
                                ì‹œê¸‰ì„±/íƒ€ì´ë°</div>
                              <div class="tooltip-line"><span>5ì </span> Â· ì¦‰ì‹œ
                                í•„ìš” / ê³„ì•½Â·ê·œì œ ë“± ê¸´ê¸‰ ì‚¬ìœ </div>
                              <div class="tooltip-line"><span>3ì </span> Â· ë¶„ê¸°
                                ë‚´ ê²€í†  í•„ìš” / ì¼ì • ì¼ë¶€ ì¡´ì¬</div>
                              <div class="tooltip-line"><span>1ì </span> Â· ê¸‰í•˜ì§€
                                ì•ŠìŒ / ê³„íš ì—†ìŒ</div>
                            </div>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>ë„ì… ìš©ì´ì„±</td>
                        <td>
                          <select data-dw-score="timelineEase">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon"
                            data-tooltip-id="tt-timeline-ease">i
                            <div class="tooltip" id="tt-timeline-ease">
                              <div class="tooltip-title">Timeline Â· ë„ì…
                                ìš©ì´ì„±</div>
                              <div class="tooltip-line"><span>5ì </span> Â· ì¦‰ì‹œ
                                ì‚¬ìš© ê°€ëŠ¥ / ë¦¬ìŠ¤í¬ ê±°ì˜ ì—†ìŒ</div>
                              <div class="tooltip-line"><span>3ì </span> Â·
                                ì¼ë°˜ì  ë‚œì´ë„ / ë³´í†µ ìˆ˜ì¤€</div>
                              <div class="tooltip-line"><span>1ì </span> Â·
                                ê¸°ìˆ ì  ì¥ì•  í¼ / í†µí•© ì–´ë ¤ì›€</div>
                            </div>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <div>
                  <div class="weight-card">
                    <div class="weight-card-header">
                      <div class="weight-card-title">ê°€ì¤‘ì¹˜ ì„¤ì •</div>
                      <span class="pill-muted">í•©ê³„ = 1.00</span>
                    </div>
                    <div class="weight-row">
                      <span>Budget</span>
                      <input type="number" step="0.01" class="weight-input"
                        id="dwWeightBudget" value="0.30" />
                    </div>
                    <div class="weight-row">
                      <span>Need</span>
                      <input type="number" step="0.01" class="weight-input"
                        id="dwWeightNeed" value="0.30" />
                    </div>
                    <div class="weight-row">
                      <span>Authority</span>
                      <input type="number" step="0.01" class="weight-input"
                        id="dwWeightAuthority" value="0.25" />
                    </div>
                    <div class="weight-row">
                      <span>Timeline</span>
                      <input type="number" step="0.01" class="weight-input"
                        id="dwWeightTimeline" value="0.15" />
                    </div>
                    <div id="dwWeightSumText" class="weight-sum">
                      í•©ê³„: 1.00
                    </div>
                    <div class="helper-text">
                      í•©ê³„ê°€ 1ì´ ì•„ë‹ ê²½ìš° ê²°ê³¼ ê³„ì‚°ì´ ë¹„í™œì„±í™”ë©ë‹ˆë‹¤.
                    </div>
                  </div>
                </div>
              </div>

              <div class="section-footer">
                <div class="helper-text">
                  ëª¨ë“  í•­ëª©ì˜ ì ìˆ˜ì™€ ê°€ì¤‘ì¹˜ë¥¼ ì„¤ì •í•œ ë’¤, ê²°ê³¼ ë³´ê¸°ë¥¼ ëˆŒëŸ¬
                  Deal Scoreì™€ Win Probabilityë¥¼ í™•ì¸í•˜ì„¸ìš”.
                </div>
                <div>
                  <button class="btn-secondary" id="dealWinResultButton">
                    ê²°ê³¼ ë³´ê¸°
                  </button>
                </div>
              </div>

              <div id="dealWinResultArea" style="display:none;">
                <div class="result-summary">
                  <div class="result-pill">
                    <div>
                      <div class="result-label">Deal Score</div>
                      <div id="dealScoreValue">-</div>
                    </div>
                    <div>
                      <div class="result-label">Win Probability</div>
                      <div id="winProbValue">-</div>
                    </div>
                  </div>
                </div>
                <div class="risk-card">
                  <div class="risk-card-header">
                    <div class="risk-card-title">Risk Summary</div>
                    <span class="risk-chip">í•©ì‚° ì ìˆ˜ 2 ì´í•˜ í•­ëª©</span>
                  </div>
                  <ul class="risk-list" id="dealWinRiskList"></ul>
                </div>
              </div>
            </div>
          </div>

          <!-- Collapsed Technical summary -->
          <div id="techFitSummaryBar" class="summary-bar" style="display:none;">
            <div>
              <span class="label">Technical Fit Score</span>
              <small id="techFitSummaryText"></small>
            </div>
            <button class="collapse-toggle"
              data-target="techFitSectionBody">
              <span>í¼ì¹˜ê¸°/ì ‘ê¸°</span> â–¼
            </button>
          </div>

          <!-- Technical Fit Score Section -->
          <div class="section-card" id="techFitSection" style="display:none;">
            <div class="section-header">
              <div>
                <div class="section-title">
                  <span>Technical Fit Score</span>
                  <span class="pill-muted">Technical Risk</span>
                </div>
                <div class="section-subtitle">
                  ê¸°ëŠ¥, ì¸í”„ë¼, ê·œì œ/ë³´ì•ˆ, ì‹¤í–‰ ê°€ëŠ¥ì„± ê´€ì ì—ì„œ ê¸°ìˆ ì  ë¦¬ìŠ¤í¬ë¥¼
                  í‰ê°€í•©ë‹ˆë‹¤.
                </div>
              </div>
              <button class="collapse-toggle"
                data-target="techFitSectionBody">
                <span>ì ‘ê¸°</span> â–²
              </button>
            </div>
            <div class="section-body" id="techFitSectionBody">
              <div class="grid-two">
                <div>
                  <table class="score-table">
                    <caption>
                      ê° ì í•©ì„± í•­ëª©ì— 1~5 ì ì„ ë¶€ì—¬í•˜ì„¸ìš”. (5ì ì´ ê°€ì¥
                      ì í•©)
                    </caption>
                    <thead>
                      <tr>
                        <th style="width:40%;">ì í•©ì„± í•­ëª©</th>
                        <th style="width:40%;">ì„¸ë¶€ í•­ëª©</th>
                        <th style="width:10%;">ì ìˆ˜</th>
                        <th style="width:10%;text-align:center;">i</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="group-row">
                        <td>Technical Fit</td>
                        <td colspan="3">ê¸°ëŠ¥ ì í•©ì„± / ì»¤ìŠ¤í„°ë§ˆì´ì§• / ë ˆê±°ì‹œ</td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>ê¸°ëŠ¥ ì í•©ì„±</td>
                        <td>
                          <select data-tf-score="tfFunctional">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon"
                            data-tooltip-id="tt-tf-functional">i
                            <div class="tooltip" id="tt-tf-functional">
                              <div class="tooltip-title">Technical Fit Â· ê¸°ëŠ¥
                                ì í•©ì„±</div>
                              <div class="tooltip-line"><span>5ì </span> Â· ìš”êµ¬ì‚¬í•­
                                ì™„ì „ ì¼ì¹˜ / ìµœì  Fit</div>
                              <div class="tooltip-line"><span>3ì </span> Â· ì£¼ìš”
                                ê¸°ëŠ¥ ëŒ€ë¶€ë¶„ ì¶©ì¡± / ë³´í†µ ìˆ˜ì¤€</div>
                              <div class="tooltip-line"><span>1ì </span> Â· ìš”êµ¬
                                ê¸°ëŠ¥ ëŒ€ë¶€ë¶„ ë¶ˆì¼ì¹˜ / êµ¬í˜„ ì–´ë ¤ì›€</div>
                            </div>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>ì»¤ìŠ¤í„°ë§ˆì´ì§• í•„ìš”ë„</td>
                        <td>
                          <select data-tf-score="tfCustomization">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon"
                            data-tooltip-id="tt-tf-customization">i
                            <div class="tooltip" id="tt-tf-customization">
                              <div class="tooltip-title">Technical Fit Â·
                                ì»¤ìŠ¤í„°ë§ˆì´ì§• í•„ìš”ë„</div>
                              <div class="tooltip-line"><span>5ì </span> Â·
                                êµ¬ì„±ë§Œìœ¼ë¡œ ì¦‰ì‹œ ì ìš© ê°€ëŠ¥</div>
                              <div class="tooltip-line"><span>3ì </span> Â· ì¼ë°˜ì 
                                ë‚œì´ë„ / êµ¬í˜„ ê°€ëŠ¥</div>
                              <div class="tooltip-line"><span>1ì </span> Â·
                                ì»¤ìŠ¤í„°ë§ˆì´ì§• ë§ìŒ / ë†’ì€ ë³µì¡ë„</div>
                            </div>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>ë ˆê±°ì‹œ ì œì•½</td>
                        <td>
                          <select data-tf-score="tfLegacy">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon"
                            data-tooltip-id="tt-tf-legacy">i
                            <div class="tooltip" id="tt-tf-legacy">
                              <div class="tooltip-title">Technical Fit Â· ë ˆê±°ì‹œ
                                ì œì•½</div>
                              <div class="tooltip-line"><span>5ì </span> Â· ì œì•½ ê±°ì˜
                                ì—†ìŒ / ìµœì  í™˜ê²½</div>
                              <div class="tooltip-line"><span>3ì </span> Â· ì¼ë¶€
                                ì œì•½ ìˆìœ¼ë‚˜ í˜„ì‹¤ì  ëŒ€ì•ˆ ì¡´ì¬</div>
                              <div class="tooltip-line"><span>1ì </span> Â· ë ˆê±°ì‹œ
                                ì œì•½ ì‹¬ê° / ì—°ë™ ë¶ˆê°€</div>
                            </div>
                          </div>
                        </td>
                      </tr>

                      <tr class="group-row">
                        <td>Environment &amp; Integration</td>
                        <td colspan="3">ì¸í”„ë¼ / ì—°ë™ / ë„¤íŠ¸ì›Œí¬ ì œì•½</td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>ì¸í”„ë¼ í˜¸í™˜ì„±</td>
                        <td>
                          <select data-tf-score="envInfra">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon"
                            data-tooltip-id="tt-env-infra">i
                            <div class="tooltip" id="tt-env-infra">
                              <div class="tooltip-title">Environment Â· ì¸í”„ë¼
                                í˜¸í™˜ì„±</div>
                              <div class="tooltip-line"><span>5ì </span> Â· ì™„ì „
                                í˜¸í™˜ / ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥</div>
                              <div class="tooltip-line"><span>3ì </span> Â· ë³´í†µ
                                ìˆ˜ì¤€ í˜¸í™˜ / ì¼ë¶€ ê²€ì¦ í•„ìš”</div>
                              <div class="tooltip-line"><span>1ì </span> Â· í˜¸í™˜
                                ê±°ì˜ ë¶ˆê°€ / ì œì•½ ë§¤ìš° í¼</div>
                            </div>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>ì—°ë™ ì§€ì› ì—¬ë¶€</td>
                        <td>
                          <select data-tf-score="envIntegration">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon"
                            data-tooltip-id="tt-env-integration">i
                            <div class="tooltip" id="tt-env-integration">
                              <div class="tooltip-title">Environment Â· ì—°ë™ ì§€ì›
                                ì—¬ë¶€</div>
                              <div class="tooltip-line"><span>5ì </span> Â· ì¦‰ì‹œ
                                ì—°ë™ ê°€ëŠ¥ / ì¥ì•  ìš”ì†Œ ì—†ìŒ</div>
                              <div class="tooltip-line"><span>3ì </span> Â· ì¼ë°˜ì 
                                ë‚œì´ë„ / í‘œì¤€ í”„ë¡œí† ì½œ ê¸°ë°˜</div>
                              <div class="tooltip-line"><span>1ì </span> Â· ì—°ë™
                                ë¶ˆê°€ í˜¹ì€ ë§¤ìš° ì–´ë ¤ì›€</div>
                            </div>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>í™˜ê²½/ë„¤íŠ¸ì›Œí¬ ì œì•½</td>
                        <td>
                          <select data-tf-score="envNetwork">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon"
                            data-tooltip-id="tt-env-network">i
                            <div class="tooltip" id="tt-env-network">
                              <div class="tooltip-title">Environment Â· í™˜ê²½ /
                                ë„¤íŠ¸ì›Œí¬ ì œì•½</div>
                              <div class="tooltip-line"><span>5ì </span> Â· ì œì•½ ê±°ì˜
                                ì—†ìŒ / ìµœì  í™˜ê²½</div>
                              <div class="tooltip-line"><span>3ì </span> Â· ì¼ë¶€
                                ì œì•½ ìˆìœ¼ë‚˜ ê´€ë¦¬ ê°€ëŠ¥</div>
                              <div class="tooltip-line"><span>1ì </span> Â·
                                ì œì•½ ë§¤ìš° ì‹¬ê°</div>
                            </div>
                          </div>
                        </td>
                      </tr>

                      <tr class="group-row">
                        <td>Compliance &amp; Security</td>
                        <td colspan="3">ë³´ì•ˆ / ê·œì œ / ë°ì´í„°Â·ë³´ì•ˆ ì í•©ì„±</td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>ë³´ì•ˆ ê²€í†  ë‚œì´ë„</td>
                        <td>
                          <select data-tf-score="compSecurity">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon"
                            data-tooltip-id="tt-comp-security">i
                            <div class="tooltip" id="tt-comp-security">
                              <div class="tooltip-title">Compliance Â· ë³´ì•ˆ ê²€í† 
                                ë‚œì´ë„</div>
                              <div class="tooltip-line"><span>5ì </span> Â· ë¬¸ì œ
                                ì—†ìŒ / ìŠ¹ì¸ í™•ì‹¤</div>
                              <div class="tooltip-line"><span>3ì </span> Â· ë³´í†µ
                                ë‚œì´ë„ / ì¼ë¶€ ê²€í†  í•„ìš”</div>
                              <div class="tooltip-line"><span>1ì </span> Â· ë³´ì•ˆ
                                ì¶©ì¡± ì–´ë ¤ì›€ / ë¦¬ìŠ¤í¬ í¼</div>
                            </div>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>ê·œì œ ì¤€ìˆ˜ ê°€ëŠ¥ì„±</td>
                        <td>
                          <select data-tf-score="compRegulatory">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon"
                            data-tooltip-id="tt-comp-reg">i
                            <div class="tooltip" id="tt-comp-reg">
                              <div class="tooltip-title">Compliance Â· ê·œì œ ì¤€ìˆ˜
                                ê°€ëŠ¥ì„±</div>
                              <div class="tooltip-line"><span>5ì </span> Â· ì™„ì „
                                ì¶©ì¡± / ê²€ì¦ ë¬¸ì œ ì—†ìŒ</div>
                              <div class="tooltip-line"><span>3ì </span> Â·
                                ëŒ€ë¶€ë¶„ ì¶©ì¡± / ì¶”ê°€ ì¡°ì • í•„ìš”</div>
                              <div class="tooltip-line"><span>1ì </span> Â· ê·œì œ
                                ì¶©ì¡± ë¶ˆê°€</div>
                            </div>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>ë°ì´í„°/ë³´ì•ˆ ì í•©ì„±</td>
                        <td>
                          <select data-tf-score="compData">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon"
                            data-tooltip-id="tt-comp-data">i
                            <div class="tooltip" id="tt-comp-data">
                              <div class="tooltip-title">Compliance Â· ë°ì´í„°/ë³´ì•ˆ
                                ì í•©ì„±</div>
                              <div class="tooltip-line"><span>5ì </span> Â· ì™„ì „
                                ì í•© / ìš”êµ¬ ì¶©ì¡±</div>
                              <div class="tooltip-line"><span>3ì </span> Â·
                                ëŒ€ë¶€ë¶„ ì¶©ì¡± / ì¡°ì • ê°€ëŠ¥</div>
                              <div class="tooltip-line"><span>1ì </span> Â· ìš”êµ¬
                                ê¸°ì¤€ê³¼ ë¶ˆì¼ì¹˜</div>
                            </div>
                          </div>
                        </td>
                      </tr>

                      <tr class="group-row">
                        <td>Human &amp; Execution Readiness</td>
                        <td colspan="3">ê³ ê° ê¸°ìˆ íŒ€ / ì§€ì› ë¦¬ì†ŒìŠ¤ / ì¼ì • í˜„ì‹¤ì„±</td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>ê³ ê° ê¸°ìˆ íŒ€ ì¤€ë¹„ë„</td>
                        <td>
                          <select data-tf-score="humanTeam">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon"
                            data-tooltip-id="tt-human-team">i
                            <div class="tooltip" id="tt-human-team">
                              <div class="tooltip-title">Human Â· ê³ ê° ê¸°ìˆ íŒ€
                                ì¤€ë¹„ë„</div>
                              <div class="tooltip-line"><span>5ì </span> Â· ë§¤ìš°
                                ì ê·¹ì  / ì „ë¬¸ì„± ë†’ìŒ</div>
                              <div class="tooltip-line"><span>3ì </span> Â· ê¸°ë³¸
                                ì—­ëŸ‰ ì¶©ë¶„ / ì¼ë°˜ì  ìˆ˜í–‰ ê°€ëŠ¥</div>
                              <div class="tooltip-line"><span>1ì </span> Â· ë¦¬ì†ŒìŠ¤
                                ì—†ìŒ / ì§„í–‰ ë¶ˆê°€</div>
                            </div>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>ë„ì… ì§€ì› ë¦¬ì†ŒìŠ¤</td>
                        <td>
                          <select data-tf-score="humanSupport">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon"
                            data-tooltip-id="tt-human-support">i
                            <div class="tooltip" id="tt-human-support">
                              <div class="tooltip-title">Human Â· ë„ì… ì§€ì›
                                ë¦¬ì†ŒìŠ¤</div>
                              <div class="tooltip-line"><span>5ì </span> Â· ì¦‰ì‹œ
                                íˆ¬ì… ê°€ëŠ¥ / ì—¬ìœ  ìˆìŒ</div>
                              <div class="tooltip-line"><span>3ì </span> Â·
                                ì¼ë°˜ì  ìˆ˜ì¤€ / ì¼ë¶€ ì¡°ìœ¨ í•„ìš”</div>
                              <div class="tooltip-line"><span>1ì </span> Â· ì§€ì›
                                ë¦¬ì†ŒìŠ¤ ê±°ì˜ ì—†ìŒ</div>
                            </div>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>ì¼ì •/ë²”ìœ„ í˜„ì‹¤ì„±</td>
                        <td>
                          <select data-tf-score="humanTimeline">
                            <option value="">-</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                          </select>
                        </td>
                        <td style="text-align:center;">
                          <div class="info-icon"
                            data-tooltip-id="tt-human-timeline">i
                            <div class="tooltip" id="tt-human-timeline">
                              <div class="tooltip-title">Human Â· ì¼ì •/ë²”ìœ„
                                í˜„ì‹¤ì„±</div>
                              <div class="tooltip-line"><span>5ì </span> Â· ì¦‰ì‹œ
                                ì°©ìˆ˜ ê°€ëŠ¥ / ê°•í•œ ì¶”ì§„ë ¥</div>
                              <div class="tooltip-line"><span>3ì </span> Â· ì¼ì •
                                ì¡´ì¬ / ë³€ë™ ê°€ëŠ¥ì„± ìˆìŒ</div>
                              <div class="tooltip-line"><span>1ì </span> Â· ì¼ì •
                                ë¶ˆëª…í™• / ì‹¤í˜„ ì–´ë ¤ì›€</div>
                            </div>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <div>
                  <div class="weight-card">
                    <div class="weight-card-header">
                      <div class="weight-card-title">ê°€ì¤‘ì¹˜ ì„¤ì •</div>
                      <span class="pill-muted">í•©ê³„ = 1.00</span>
                    </div>
                    <div class="weight-row">
                      <span>Technical Fit</span>
                      <input type="number" step="0.01" class="weight-input"
                        id="tfWeightTechnicalFit" value="0.35" />
                    </div>
                    <div class="weight-row">
                      <span>Environment &amp; Integration</span>
                      <input type="number" step="0.01" class="weight-input"
                        id="tfWeightEnvironment" value="0.25" />
                    </div>
                    <div class="weight-row">
                      <span>Compliance &amp; Security</span>
                      <input type="number" step="0.01" class="weight-input"
                        id="tfWeightCompliance" value="0.20" />
                    </div>
                    <div class="weight-row">
                      <span>Human &amp; Execution</span>
                      <input type="number" step="0.01" class="weight-input"
                        id="tfWeightHuman" value="0.20" />
                    </div>
                    <div id="tfWeightSumText" class="weight-sum">
                      í•©ê³„: 1.00
                    </div>
                    <div class="helper-text">
                      í•©ê³„ê°€ 1ì´ ì•„ë‹ ê²½ìš° ê²°ê³¼ ê³„ì‚°ì´ ë¹„í™œì„±í™”ë©ë‹ˆë‹¤.
                    </div>
                  </div>
                </div>
              </div>

              <div class="section-footer">
                <div class="helper-text">
                  ëª¨ë“  ì í•©ì„± í•­ëª©ê³¼ ê°€ì¤‘ì¹˜ë¥¼ ì„¤ì •í•œ ë’¤, ê²°ê³¼ ë³´ê¸°ë¥¼ ëˆŒëŸ¬ Technical Fit
                  Scoreì™€ Risk Levelì„ í™•ì¸í•˜ì„¸ìš”.
                </div>
                <div>
                  <button class="btn-secondary" id="techFitResultButton">
                    ê²°ê³¼ ë³´ê¸°
                  </button>
                </div>
              </div>

              <div id="techFitResultArea" style="display:none;">
                <div class="result-summary">
                  <div class="result-pill">
                    <div>
                      <div class="result-label">Technical Fit Score</div>
                      <div id="techScoreValue">-</div>
                    </div>
                    <div>
                      <div class="result-label">Risk Level</div>
                      <div id="techRiskValue">-</div>
                    </div>
                  </div>
                </div>
                <div class="risk-card">
                  <div class="risk-card-header">
                    <div class="risk-card-title">Risk Summary</div>
                    <span class="risk-chip">í•©ì‚° ì ìˆ˜ 2 ì´í•˜ í•­ëª©</span>
                  </div>
                  <ul class="risk-list" id="techFitRiskList"></ul>
                </div>
              </div>
            </div>
          </div>

          <!-- Dashboard Section -->
          <div class="section-card" id="dashboardSection" style="display:none;">
            <div class="section-header">
              <div>
                <div class="section-title">
                  <span>Dashboard</span>
                  <span class="pill-muted">Quadrant View</span>
                </div>
                <div class="section-subtitle">
                  Business Fit (Deal Win Score)ì™€ Technical Fitì„ 2Ã—2 Quadrantë¡œ ì‹œê°í™”í•©ë‹ˆë‹¤.
                </div>
              </div>
            </div>
            <div class="section-body">
              <div class="metrics-row">
                <div class="metric-card">
                  <div class="metric-label">Deal Win Score</div>
                  <div class="metric-value" id="metricDealScore">-</div>
                  <div class="metric-sub" id="metricWinProb">-</div>
                </div>
                <div class="metric-card">
                  <div class="metric-label">Technical Fit Score</div>
                  <div class="metric-value" id="metricTechScore">-</div>
                  <div class="metric-sub" id="metricTechRisk">-</div>
                </div>
              </div>
              <div class="dashboard-grid">
                <div class="quadrant-card">
                  <div class="quadrant-header">
                    <span>Business vs Technical Fit</span>
                    <span class="pill-muted">ì ìˆ˜ê°€ ë†’ì„ìˆ˜ë¡ ì˜¤ë¥¸ìª½Â·ìœ„ìª½</span>
                  </div>
                  <canvas id="quadrantCanvas"></canvas>
                </div>
                <div class="summary-card">
                  <div class="summary-zone" id="summaryZone">-</div>
                  <div class="summary-body" id="summaryBody">
                    Deal ì ìˆ˜ì— ê¸°ë°˜í•œ ì´í‰ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
                  </div>
                  <div class="summary-actions" id="summaryActions">
                    ê¶Œì¥ ì•¡ì…˜ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Admin Tab -->
        <section class="section" id="tab-admin" style="display:none;">
          <div class="section-card">
            <div class="section-header">
              <div>
                <div class="section-title">
                  <span>Admin</span>
                  <span class="pill-muted">Saved Deals</span>
                </div>
                <div class="section-subtitle">
                  Dashboardê¹Œì§€ í‰ê°€ë¥¼ ì™„ë£Œí•œ Deal ëª©ë¡ì…ë‹ˆë‹¤. í´ë¦­í•˜ì—¬ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê±°ë‚˜ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </div>
              </div>
            </div>
            <div class="section-body">
              <div id="adminList" class="admin-list">
                <div class="admin-empty">ì €ì¥ëœ Dealì´ ì—†ìŠµë‹ˆë‹¤.</div>
              </div>
            </div>
          </div>
        </section>
      </div>
    </main>
  </div>

  <!-- Modal -->
  <div class="modal-backdrop" id="modalBackdrop">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title" id="modalTitle"></div>
        <button class="btn-ghost" id="modalCloseButton">âœ•</button>
      </div>
      <div class="modal-body" id="modalBody"></div>
      <div class="modal-sub" id="modalSub"></div>
    </div>
  </div>

  <script>
    // --- State ---
    let currentDeal = null; // will hold meta + scores + dashboard

    function createEmptyDeal() {
      return {
        id: Date.now().toString(),
        createdAt: new Date().toISOString(),
        meta: {
          name: "",
          description: ""
        },
        dealWin: null,
        techFit: null,
        dashboard: null
      };
    }

    // --- Utility ---
    function $(selector) {
      return document.querySelector(selector);
    }

    function $all(selector) {
      return Array.from(document.querySelectorAll(selector));
    }

    function showElement(el) {
      if (el) el.style.display = "";
    }

    function hideElement(el) {
      if (el) el.style.display = "none";
    }

    function toNumber(val) {
      const n = parseFloat(val);
      return isNaN(n) ? 0 : n;
    }

    function round(val, digits = 0) {
      const factor = Math.pow(10, digits);
      return Math.round(val * factor) / factor;
    }

    // --- Tabs ---
    function initTabs() {
      const tabButtons = $all(".tab-button");
      tabButtons.forEach(btn => {
        btn.addEventListener("click", () => {
          const tab = btn.dataset.tab;
          tabButtons.forEach(b => {
            b.classList.toggle("active", b === btn);
            b.setAttribute("aria-selected", b === btn ? "true" : "false");
          });
          if (tab === "qualification") {
            showElement($("#tab-qualification"));
            hideElement($("#tab-admin"));
          } else {
            hideElement($("#tab-qualification"));
            showElement($("#tab-admin"));
            renderAdminList();
          }
        });
      });
    }

    // --- Start / Deal Info ---
    function initDealInfo() {
      $("#startDealButton").addEventListener("click", () => {
        if (!currentDeal) {
          currentDeal = createEmptyDeal();
        }
        showElement($("#dealInfoSection"));
        $("#dealNameInput").focus();
      });

      $("#dealInfoCompleteButton").addEventListener("click", () => {
        const nameInput = $("#dealNameInput");
        const descInput = $("#dealDescriptionInput");
        const errorEl = $("#dealNameError");
        const name = nameInput.value.trim();
        if (!name) {
          errorEl.style.display = "block";
          return;
        }
        errorEl.style.display = "none";

        if (!currentDeal) {
          currentDeal = createEmptyDeal();
        }
        currentDeal.meta.name = name;
        currentDeal.meta.description = descInput.value.trim();

        // Show Deal Win section
        showElement($("#dealWinSection"));
        $("#dealWinSection").scrollIntoView({ behavior: "smooth", block: "start" });
      });

      $("#dealNameInput").addEventListener("input", () => {
        $("#dealNameError").style.display = "none";
      });
    }

    // --- Tooltip ---
    function initTooltips() {
      $all(".info-icon").forEach(icon => {
        const tooltipId = icon.dataset.tooltipId;
        const tooltip = $("#" + tooltipId);
        if (!tooltip) return;

        function show() {
          tooltip.classList.add("visible");
        }
        function hide() {
          tooltip.classList.remove("visible");
        }

        icon.addEventListener("mouseenter", show);
        icon.addEventListener("mouseleave", hide);
        icon.addEventListener("click", () => {
          tooltip.classList.toggle("visible");
        });
      });

      document.addEventListener("click", (e) => {
        if (!e.target.closest(".info-icon")) {
          $all(".tooltip.visible").forEach(t => t.classList.remove("visible"));
        }
      });
    }

    // --- Weights ---
    function updateWeightSum(type) {
      if (type === "dw") {
        const wB = toNumber($("#dwWeightBudget").value);
        const wN = toNumber($("#dwWeightNeed").value);
        const wA = toNumber($("#dwWeightAuthority").value);
        const wT = toNumber($("#dwWeightTimeline").value);
        const sum = wB + wN + wA + wT;
        const textEl = $("#dwWeightSumText");
        textEl.textContent = "í•©ê³„: " + sum.toFixed(2);
        if (Math.abs(sum - 1) > 0.001) {
          textEl.classList.add("error");
          $("#dealWinResultButton").disabled = true;
        } else {
          textEl.classList.remove("error");
          $("#dealWinResultButton").disabled = false;
        }
      } else if (type === "tf") {
        const wt = toNumber($("#tfWeightTechnicalFit").value);
        const we = toNumber($("#tfWeightEnvironment").value);
        const wc = toNumber($("#tfWeightCompliance").value);
        const wh = toNumber($("#tfWeightHuman").value);
        const sum = wt + we + wc + wh;
        const textEl = $("#tfWeightSumText");
        textEl.textContent = "í•©ê³„: " + sum.toFixed(2);
        if (Math.abs(sum - 1) > 0.001) {
          textEl.classList.add("error");
          $("#techFitResultButton").disabled = true;
        } else {
          textEl.classList.remove("error");
          $("#techFitResultButton").disabled = false;
        }
      }
    }

    function initWeightInputs() {
      ["#dwWeightBudget", "#dwWeightNeed", "#dwWeightAuthority", "#dwWeightTimeline"]
        .forEach(id => {
          $(id).addEventListener("input", () => updateWeightSum("dw"));
        });

      ["#tfWeightTechnicalFit", "#tfWeightEnvironment", "#tfWeightCompliance", "#tfWeightHuman"]
        .forEach(id => {
          $(id).addEventListener("input", () => updateWeightSum("tf"));
        });

      updateWeightSum("dw");
      updateWeightSum("tf");
    }

    // --- Modal ---
    function showModal(title, body, sub = "") {
      $("#modalTitle").textContent = title;
      $("#modalBody").textContent = body;
      $("#modalSub").textContent = sub;
      $("#modalBackdrop").classList.add("visible");
    }

    function hideModal() {
      $("#modalBackdrop").classList.remove("visible");
    }

    function initModal() {
      $("#modalCloseButton").addEventListener("click", hideModal);
      $("#modalBackdrop").addEventListener("click", (e) => {
        if (e.target === $("#modalBackdrop")) {
          hideModal();
        }
      });
    }

    // --- Collapse toggles ---
    function initCollapse() {
      $all(".collapse-toggle").forEach(btn => {
        btn.addEventListener("click", () => {
          const targetId = btn.dataset.target;
          const body = $("#" + targetId);
          if (!body) return;
          const collapsed = body.classList.toggle("collapsed");
          btn.innerHTML = collapsed ? '<span>í¼ì¹˜ê¸°</span> â–¼' : '<span>ì ‘ê¸°</span> â–²';
        });
      });
    }

    // --- Deal Win Score calculation ---
    function calculateDealWin() {
      const selects = $all("[data-dw-score]");
      const scores = {};
      for (const sel of selects) {
        const key = sel.dataset.dwScore;
        const val = sel.value;
        if (!val) {
          alert("Deal Win Scoreì˜ ëª¨ë“  ì ìˆ˜ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
          return null;
        }
        scores[key] = parseInt(val, 10);
      }

      const wB = toNumber($("#dwWeightBudget").value);
      const wN = toNumber($("#dwWeightNeed").value);
      const wA = toNumber($("#dwWeightAuthority").value);
      const wT = toNumber($("#dwWeightTimeline").value);
      const sumW = wB + wN + wA + wT;
      if (Math.abs(sumW - 1) > 0.001) {
        alert("Deal Win ê°€ì¤‘ì¹˜ í•©ì´ 1ì´ ë˜ë„ë¡ ì¡°ì •í•´ ì£¼ì„¸ìš”.");
        return null;
      }

      const budgetSum = scores.budgetReadiness;
      const authoritySum = (scores.authorityChampion + scores.authorityAccess) / 2;
      const needSum = (scores.needFit + scores.needCompetition) / 2;
      const timelineSum = (scores.timelineUrgency + scores.timelineEase) / 2;

      const raw =
        (wB * budgetSum) +
        (wA * authoritySum) +
        (wN * needSum) +
        (wT * timelineSum);

      const dealScore = Math.max(0, Math.min(100, (raw / 5) * 100));

      let winProb = 10;
      let label = "ë§¤ìš° ë‚®ìŒ";
      if (dealScore >= 81) {
        winProb = 90; label = "ë§¤ìš° ë†’ìŒ";
      } else if (dealScore >= 61) {
        winProb = 70; label = "ë†’ìŒ";
      } else if (dealScore >= 41) {
        winProb = 50; label = "ì¤‘ê°„";
      } else if (dealScore >= 21) {
        winProb = 30; label = "ë‚®ìŒ";
      }

      const riskMessages = [];
      if (budgetSum <= 2) {
        riskMessages.push("ì˜ˆì‚° ë¦¬ìŠ¤í¬: êµ¬ë§¤ ê°€ëŠ¥ì„± ë‚®ìŒ (Budget í•©ì‚° â‰¤ 2)");
      }
      if (authoritySum <= 2) {
        riskMessages.push("Authority ë¦¬ìŠ¤í¬: ì±”í”¼ì–¸Â·ì˜ì‚¬ê²°ì •ì ì˜í–¥ë ¥ ë¶€ì¡± (Authority í•©ì‚° â‰¤ 2)");
      }
      if (needSum <= 2) {
        riskMessages.push("Need ë¦¬ìŠ¤í¬: Problem-Solution Fit ì•½í•¨ í˜¹ì€ ê²½ìŸ ì—´ìœ„ (Need í•©ì‚° â‰¤ 2)");
      }
      if (timelineSum <= 2) {
        riskMessages.push("íƒ€ì´ë° ë¦¬ìŠ¤í¬: ì‹œê¸‰ì„±/ë„ì… ìš©ì´ì„± ë‚®ìŒ (Timeline í•©ì‚° â‰¤ 2)");
      }

      return {
        scores,
        weights: { wB, wN, wA, wT },
        sums: {
          budget: budgetSum,
          authority: authoritySum,
          need: needSum,
          timeline: timelineSum
        },
        dealScore,
        winProb,
        winLabel: label,
        risks: riskMessages
      };
    }

    function renderDealWinResult(dw) {
      $("#dealScoreValue").textContent = dw.dealScore.toFixed(1) + " %";
      $("#winProbValue").textContent = dw.winProb + " % (" + dw.winLabel + ")";
      const list = $("#dealWinRiskList");
      list.innerHTML = "";
      if (dw.risks.length === 0) {
        const li = document.createElement("li");
        li.textContent = "íŠ¹ë³„í•œ ë¦¬ìŠ¤í¬ ì—†ìŒ (ëª¨ë“  í•©ì‚° ì ìˆ˜ > 2)";
        list.appendChild(li);
      } else {
        dw.risks.forEach(msg => {
          const li = document.createElement("li");
          li.textContent = msg;
          list.appendChild(li);
        });
      }
      showElement($("#dealWinResultArea"));

      // Summary bar text
      $("#dealWinSummaryText").textContent =
        dw.dealScore.toFixed(1) + "% Â· Win Prob " +
        dw.winProb + "% (" + dw.winLabel + ")";
      showElement($("#dealWinSummaryBar"));

      // Collapse section when moving on
      const body = $("#dealWinSectionBody");
      if (!body.classList.contains("collapsed")) {
        body.classList.add("collapsed");
      }
    }

    function initDealWin() {
      $("#dealWinResultButton").addEventListener("click", () => {
        if (!currentDeal) {
          alert("ë¨¼ì € Deal ì •ë³´ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
          return;
        }
        const dw = calculateDealWin();
        if (!dw) return;

        // Save to state
        currentDeal.dealWin = dw;
        renderDealWinResult(dw);

        // Modal
        showModal(
          "Win Probability",
          `ì´ Dealì˜ Win ProbabilityëŠ” ${dw.winProb}% (${dw.winLabel})ë¡œ í‰ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`,
          "Deal Scoreì™€ ê°€ì¤‘ì¹˜ ê¸°ë°˜ ìë™ ê³„ì‚° ê²°ê³¼ì…ë‹ˆë‹¤."
        );

        // Show Technical Fit section if not visible
        showElement($("#techFitSection"));
        $("#techFitSection").scrollIntoView({ behavior: "smooth", block: "start" });
      });
    }

    // --- Technical Fit calculation ---
    function calculateTechFit() {
      const selects = $all("[data-tf-score]");
      const scores = {};
      for (const sel of selects) {
        const key = sel.dataset.tfScore;
        const val = sel.value;
        if (!val) {
          alert("Technical Fit Scoreì˜ ëª¨ë“  ì ìˆ˜ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
          return null;
        }
        scores[key] = parseInt(val, 10);
      }

      const wt = toNumber($("#tfWeightTechnicalFit").value);
      const we = toNumber($("#tfWeightEnvironment").value);
      const wc = toNumber($("#tfWeightCompliance").value);
      const wh = toNumber($("#tfWeightHuman").value);
      const sumW = wt + we + wc + wh;
      if (Math.abs(sumW - 1) > 0.001) {
        alert("Technical Fit ê°€ì¤‘ì¹˜ í•©ì´ 1ì´ ë˜ë„ë¡ ì¡°ì •í•´ ì£¼ì„¸ìš”.");
        return null;
      }

      const techSum = (scores.tfFunctional + scores.tfCustomization + scores.tfLegacy) / 3;
      const envSum = (scores.envInfra + scores.envIntegration + scores.envNetwork) / 3;
      const compSum = (scores.compSecurity + scores.compRegulatory + scores.compData) / 3;
      const humanSum = (scores.humanTeam + scores.humanSupport + scores.humanTimeline) / 3;

      const raw =
        (wt * techSum) +
        (we * envSum) +
        (wc * compSum) +
        (wh * humanSum);

      const techScore = Math.max(0, Math.min(100, (raw / 5) * 100));

      let riskLevel = "ë§¤ìš° ë†’ìŒ";
      let riskLabel = "ê¸°ìˆ ì  ë¶ˆê°€";
      if (techScore >= 81) {
        riskLevel = "ë§¤ìš° ë‚®ìŒ"; riskLabel = "ë§¤ìš° ì í•©";
      } else if (techScore >= 61) {
        riskLevel = "ë‚®ìŒ"; riskLabel = "ì í•©í•¨";
      } else if (techScore >= 41) {
        riskLevel = "ì¤‘ê°„"; riskLabel = "ì£¼ì˜ í•„ìš”";
      } else if (techScore >= 21) {
        riskLevel = "ë†’ìŒ"; riskLabel = "ì¤‘ë‹¨ ê³ ë ¤";
      }

      const riskMessages = [];
      if (techSum <= 2) {
        riskMessages.push("Technical Fit ë¦¬ìŠ¤í¬: ê¸°ëŠ¥Â·ì»¤ìŠ¤í„°ë§ˆì´ì§•Â·ë ˆê±°ì‹œ ì œì•½ í¼ (í•©ì‚° â‰¤ 2)");
      }
      if (envSum <= 2) {
        riskMessages.push("í™˜ê²½/ì—°ë™ ë¦¬ìŠ¤í¬: ì¸í”„ë¼Â·ì—°ë™Â·ë„¤íŠ¸ì›Œí¬ ì œì•½ í¼ (í•©ì‚° â‰¤ 2)");
      }
      if (compSum <= 2) {
        riskMessages.push("ê·œì œ/ë³´ì•ˆ ë¦¬ìŠ¤í¬: ìŠ¹ì¸ ë‚œì´ë„ ë§¤ìš° ë†’ìŒ (í•©ì‚° â‰¤ 2)");
      }
      if (humanSum <= 2) {
        riskMessages.push("ì‹¤í–‰ ë¦¬ìŠ¤í¬: ê³ ê° ë¦¬ì†ŒìŠ¤Â·ì¼ì • ì¤€ë¹„ ë¶€ì¡± (í•©ì‚° â‰¤ 2)");
      }

      return {
        scores,
        weights: { wt, we, wc, wh },
        sums: {
          tech: techSum,
          env: envSum,
          comp: compSum,
          human: humanSum
        },
        techScore,
        riskLevel,
        riskLabel,
        risks: riskMessages
      };
    }

    function renderTechFitResult(tf) {
      $("#techScoreValue").textContent = tf.techScore.toFixed(1) + " %";
      $("#techRiskValue").textContent = tf.riskLevel + " (" + tf.riskLabel + ")";
      const list = $("#techFitRiskList");
      list.innerHTML = "";
      if (tf.risks.length === 0) {
        const li = document.createElement("li");
        li.textContent = "íŠ¹ë³„í•œ ë¦¬ìŠ¤í¬ ì—†ìŒ (ëª¨ë“  í•©ì‚° ì ìˆ˜ > 2)";
        list.appendChild(li);
      } else {
        tf.risks.forEach(msg => {
          const li = document.createElement("li");
          li.textContent = msg;
          list.appendChild(li);
        });
      }
      showElement($("#techFitResultArea"));

      // Summary bar
      $("#techFitSummaryText").textContent =
        tf.techScore.toFixed(1) + "% Â· Risk " +
        tf.riskLevel + " (" + tf.riskLabel + ")";
      showElement($("#techFitSummaryBar"));

      // Collapse body
      const body = $("#techFitSectionBody");
      if (!body.classList.contains("collapsed")) {
        body.classList.add("collapsed");
      }
    }

    function initTechFit() {
      $("#techFitResultButton").addEventListener("click", () => {
        if (!currentDeal || !currentDeal.dealWin) {
          alert("ë¨¼ì € Deal Win Scoreë¥¼ ê³„ì‚°í•´ ì£¼ì„¸ìš”.");
          return;
        }
        const tf = calculateTechFit();
        if (!tf) return;

        currentDeal.techFit = tf;
        renderTechFitResult(tf);

        showModal(
          "Technical Fit Level",
          `ì´ Dealì˜ Technical Fit ScoreëŠ” ${tf.techScore.toFixed(1)}%ì´ë©°, ë¦¬ìŠ¤í¬ ë ˆë²¨ì€ ${tf.riskLevel} (${tf.riskLabel})ì…ë‹ˆë‹¤.`,
          "ê¸°ìˆ Â·í™˜ê²½Â·ê·œì œÂ·ì‹¤í–‰ ê´€ì ì˜ ì í•©ì„±ì„ ì¢…í•©í•œ ê²°ê³¼ì…ë‹ˆë‹¤."
        );

        // Show Dashboard
        renderDashboard();
        showElement($("#dashboardSection"));
        $("#dashboardSection").scrollIntoView({ behavior: "smooth", block: "start" });

        // Save deal
        saveDealToStorage(currentDeal);
        renderAdminList();
      });
    }

    // --- Dashboard / Quadrant ---
    function computeZone(business, tech) {
      if (business >= 50 && tech >= 50) return "strong";
      if (business >= 50 && tech < 50) return "bizOkTechRisk";
      if (business < 50 && tech >= 50) return "techOkBizWeak";
      return "noGo";
    }

    function generateDashboardText(dw, tf) {
      const business = dw.dealScore;
      const tech = tf.techScore;
      const zoneKey = computeZone(business, tech);

      let zoneTitle = "";
      let body = "";
      const actions = [];

      const auth = dw.sums.authority;
      const budget = dw.sums.budget;
      const need = dw.sums.need;
      const timeline = dw.sums.timeline;

      if (zoneKey === "strong") {
        zoneTitle = "Strong Opportunity (ìš°ìƒë¶„ë©´ Â· Go)";
        body =
          `ì´ ë”œì€ Business Fit ${business.toFixed(1)}%, Technical Fit ${tech.toFixed(1)}%ë¡œ ì „ë°˜ì ìœ¼ë¡œ ê°•í•œ ê¸°íšŒì…ë‹ˆë‹¤. ` +
          `í•µì‹¬ ë¦¬ìŠ¤í¬ë¥¼ ê´€ë¦¬í•œë‹¤ë©´ ë¹ ë¥¸ ì§„í–‰ê³¼ ê²½ìŸì‚¬ ì°¨ë‹¨ì´ ê°€ëŠ¥í•´ ë³´ì…ë‹ˆë‹¤.`;
        actions.push("EB/ì±”í”¼ì–¸ê³¼ ì¡°ê¸° ì •ë ¬ ë° PoC/íŒŒì¼ëŸ¿ ë²”ìœ„ í™•ì •");
        actions.push("ê²½ìŸ ë©”ì‹œì§€ ê°•í™” ë° ì„±ê³µ ë ˆí¼ëŸ°ìŠ¤ ê³µìœ ");
      } else if (zoneKey === "bizOkTechRisk") {
        zoneTitle = "Biz OK but Tech Risk (ìš°í•˜ë¶„ë©´)";
        body =
          `Business FitëŠ” ${business.toFixed(1)}%ë¡œ êµ¬ë§¤ ì˜ì§€ëŠ” ë†’ì§€ë§Œ, Technical FitëŠ” ${tech.toFixed(1)}%ë¡œ ê¸°ìˆ  ë¦¬ìŠ¤í¬ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ` +
          `ê¸°ìˆ ì  ì œì•½ê³¼ êµ¬í˜„ ë¦¬ìŠ¤í¬ë¥¼ íˆ¬ëª…í•˜ê²Œ ê´€ë¦¬í•˜ì§€ ì•Šìœ¼ë©´ PoC ì‹¤íŒ¨ë‚˜ ì¼ì • ì§€ì—° ê°€ëŠ¥ì„±ì´ í½ë‹ˆë‹¤.`;
        actions.push("ê¸°ìˆ  ë¦¬ìŠ¤í¬ë¥¼ ì¦‰ì‹œ ê³µìœ í•˜ê³ , í˜„ì‹¤ì ì¸ ì•„í‚¤í…ì²˜/ìš°íšŒ ë°©ì•ˆ ì œì‹œ");
        actions.push("ê²€ì¦ ê°€ëŠ¥í•œ ì„±ê³µ ê¸°ì¤€(Exit Criteria)ì„ ëª…í™•íˆ ì •ì˜");
      } else if (zoneKey === "techOkBizWeak") {
        zoneTitle = "Tech OK but Biz Weak (ì¢Œìƒë¶„ë©´)";
        body =
          `Technical FitëŠ” ${tech.toFixed(1)}%ë¡œ ë†’ì€ í¸ì´ì§€ë§Œ, Business FitëŠ” ${business.toFixed(1)}%ë¡œ ìƒëŒ€ì ìœ¼ë¡œ ì•½í•©ë‹ˆë‹¤. ` +
          `ê¸°ìˆ ì ìœ¼ë¡œëŠ” ë¬¸ì œ ì—†ì§€ë§Œ ì˜ˆì‚°Â·ìš°ì„ ìˆœìœ„Â·ì±”í”¼ì–¸ í™•ë³´ ì¸¡ë©´ì—ì„œ ì¶”ê°€ ì„¤ë“ì´ í•„ìš”í•©ë‹ˆë‹¤.`;
        actions.push("EB/ì¬ë¬´ ê´€ì ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ì„íŒ©íŠ¸(ROI, ë¦¬ìŠ¤í¬ ì ˆê°)ë¥¼ ì¬ì •ì˜");
        actions.push("ë‚´ë¶€ ì±”í”¼ì–¸ì„ ë°œêµ´í•˜ê³ , ê²½ìŸÂ·ëŒ€ì•ˆ ëŒ€ë¹„ ì°¨ë³„ ë©”ì‹œì§€ ê°•í™”");
      } else {
        zoneTitle = "No-Go Zone (ì¢Œí•˜ë¶„ë©´)";
        body =
          `Business Fit ${business.toFixed(1)}%, Technical Fit ${tech.toFixed(1)}% ëª¨ë‘ ë‚®ì€ í¸ì…ë‹ˆë‹¤. ` +
          `í˜„ì¬ ìƒíƒœì—ì„œëŠ” ìˆ˜ì£¼ ê°€ëŠ¥ì„±ì´ ë§¤ìš° ë‚®ìœ¼ë©°, ë¬´ë¦¬í•œ ì¶”ì§„ì€ ë¦¬ì†ŒìŠ¤ ë‚­ë¹„ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.`;
        actions.push("Go/No-Go ì¬ê²€í† : í•µì‹¬ ì „ì œ(ì˜ˆì‚°, íƒ€ì´ë°, Use Case) ì¬ì„¤ì • ì—¬ë¶€ íŒë‹¨");
        actions.push("ì¤‘Â·ì¥ê¸° ê´€ì ì˜ ê´€ê³„ ìœ ì§€/ì¸ì‚¬ì´íŠ¸ ê³µìœ  ì •ë„ë¡œ ìŠ¤ì½”í”„ ì¶•ì†Œ ê³ ë ¤");
      }

      // ì¶”ê°€ë¡œ íŠ¹ì • ìš”ì†Œê°€ 2 ì´í•˜ë©´ í•œ ì¤„ì”© body ë’¤ì— ë…¹ì—¬ë„ ë¨
      if (auth <= 2) {
        body += " Authority í•©ì‚°ì´ ë‚®ì•„ ë‚´ë¶€ ì±”í”¼ì–¸ ë° ì˜ì‚¬ê²°ì •ì ì ‘ê·¼ ì „ëµ ë³´ì™„ì´ í•„ìš”í•©ë‹ˆë‹¤.";
      }
      if (budget <= 2) {
        body += " Budget ì¸¡ë©´ì—ì„œ ì˜ˆì‚° í™•ë³´ ê°€ëŠ¥ì„±ì„ í˜„ì‹¤ì ìœ¼ë¡œ ì¬ì ê²€í•´ì•¼ í•©ë‹ˆë‹¤.";
      }
      if (timeline <= 2) {
        body += " Timeline í•©ì‚°ì´ ë‚®ì•„ ë„ì… ì‹œê¸°Â·ìš°ì„ ìˆœìœ„ì— ëŒ€í•œ ì¡°ìœ¨ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.";
      }

      return { zoneKey, zoneTitle, body, actions };
    }

    function drawQuadrant(business, tech) {
      const canvas = $("#quadrantCanvas");
      const ctx = canvas.getContext("2d");
      const width = canvas.width = canvas.clientWidth;
      const height = canvas.height = canvas.clientHeight;

      ctx.clearRect(0, 0, width, height);

      const padding = 30;
      const plotX0 = padding;
      const plotY0 = padding;
      const plotX1 = width - padding;
      const plotY1 = height - padding;

      const plotW = plotX1 - plotX0;
      const plotH = plotY1 - plotY0;

      function xFromScore(score) {
        return plotX0 + (score / 100) * plotW;
      }
      function yFromScore(score) {
        // 0 at bottom -> plotY1
        return plotY1 - (score / 100) * plotH;
      }

      const midX = xFromScore(50);
      const midY = yFromScore(50);

      // Quadrants
      // ì¢Œí•˜: No-Go (ë¹¨ê°•)
      ctx.fillStyle = "#C0392B";
      ctx.fillRect(plotX0, midY, midX - plotX0, plotY1 - midY);

      // ìš°í•˜: Biz OK but Tech Risk (ë…¸ë‘)
      ctx.fillStyle = "#F4C542";
      ctx.fillRect(midX, midY, plotX1 - midX, plotY1 - midY);

      // ì¢Œìƒ: Tech OK but Biz Weak (íŒŒë‘)
      ctx.fillStyle = "#5DADE2";
      ctx.fillRect(plotX0, plotY0, midX - plotX0, midY - plotY0);

      // ìš°ìƒ: Go (ì´ˆë¡)
      ctx.fillStyle = "#4CAF50";
      ctx.fillRect(midX, plotY0, plotX1 - midX, midY - plotY0);

      // Grid lines
      ctx.strokeStyle = "#9ca3af";
      ctx.lineWidth = 1;
      ctx.setLineDash([4, 4]);
      // vertical mid
      ctx.beginPath();
      ctx.moveTo(midX, plotY0);
      ctx.lineTo(midX, plotY1);
      ctx.stroke();
      // horizontal mid
      ctx.beginPath();
      ctx.moveTo(plotX0, midY);
      ctx.lineTo(plotX1, midY);
      ctx.stroke();
      ctx.setLineDash([]);

      // Axes
      ctx.strokeStyle = "#111827";
      ctx.lineWidth = 1.2;
      // X axis
      ctx.beginPath();
      ctx.moveTo(plotX0, plotY1);
      ctx.lineTo(plotX1, plotY1);
      ctx.stroke();
      // Y axis
      ctx.beginPath();
      ctx.moveTo(plotX0, plotY1);
      ctx.lineTo(plotX0, plotY0);
      ctx.stroke();

      // Labels
      ctx.fillStyle = "#111827";
      ctx.font = "11px system-ui";
      ctx.textAlign = "center";
      ctx.fillText("Business Fit (0 â†’ 100)", (plotX0 + plotX1) / 2, height - 6);
      ctx.save();
      ctx.translate(8, (plotY0 + plotY1) / 2);
      ctx.rotate(-Math.PI / 2);
      ctx.fillText("Technical Fit (0 â†’ 100)", 0, 0);
      ctx.restore();

      // Quadrant labels (centered)
      ctx.font = "12px system-ui";
      ctx.fillStyle = "#111827";
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";

      ctx.fillText("No-Go", (plotX0 + midX) / 2, (midY + plotY1) / 2);
      ctx.fillText("Biz OK but Tech Risk", (midX + plotX1) / 2, (midY + plotY1) / 2);
      ctx.fillText("Tech OK but Biz Weak", (plotX0 + midX) / 2, (plotY0 + midY) / 2);
      ctx.fillText("Go", (midX + plotX1) / 2, (plotY0 + midY) / 2); // â† Go (ëŒ€ë¬¸ì Gë§Œ)

      // Point
      const px = xFromScore(business);
      const py = yFromScore(tech);

      ctx.beginPath();
      ctx.arc(px, py, 6, 0, Math.PI * 2);
      ctx.fillStyle = "#111827";
      ctx.fill();
      ctx.lineWidth = 2;
      ctx.strokeStyle = "#f9fafb";
      ctx.stroke();

      // Label for point
      ctx.fillStyle = "#111827";
      ctx.font = "11px system-ui";
      ctx.textAlign = "left";
      ctx.textBaseline = "bottom";
      ctx.fillText(`Deal (${business.toFixed(0)}, ${tech.toFixed(0)})`, px + 8, py - 4);
    }

    function renderDashboard() {
      const dw = currentDeal.dealWin;
      const tf = currentDeal.techFit;
      if (!dw || !tf) return;

      const business = dw.dealScore;
      const tech = tf.techScore;

      $("#metricDealScore").textContent = business.toFixed(1) + " %";
      $("#metricWinProb").textContent =
        "Win Probability " + dw.winProb + "% (" + dw.winLabel + ")";

      $("#metricTechScore").textContent = tech.toFixed(1) + " %";
      $("#metricTechRisk").textContent =
        "Risk " + tf.riskLevel + " (" + tf.riskLabel + ")";

      const dashText = generateDashboardText(dw, tf);
      $("#summaryZone").textContent = dashText.zoneTitle;
      $("#summaryBody").textContent = dashText.body;
      $("#summaryActions").textContent =
        "ê¶Œì¥ ì•¡ì…˜: " + dashText.actions.join(" Â· ");

      currentDeal.dashboard = {
        businessFit: business,
        technicalFit: tech,
        zoneKey: dashText.zoneKey,
        zoneTitle: dashText.zoneTitle,
        summary: dashText.body,
        actions: dashText.actions
      };

      drawQuadrant(business, tech);
    }

    // --- LocalStorage ---
    function loadDealsFromStorage() {
      try {
        const raw = localStorage.getItem("dqDeals");
        if (!raw) return [];
        const parsed = JSON.parse(raw);
        if (!Array.isArray(parsed)) return [];
        return parsed;
      } catch (e) {
        console.error("Failed to load deals:", e);
        return [];
      }
    }

    function saveDealsToStorage(deals) {
      localStorage.setItem("dqDeals", JSON.stringify(deals));
    }

    function saveDealToStorage(deal) {
      const deals = loadDealsFromStorage();
      const idx = deals.findIndex(d => d.id === deal.id);
      const payload = {
        id: deal.id,
        createdAt: deal.createdAt,
        meta: deal.meta,
        dealWin: deal.dealWin,
        techFit: deal.techFit,
        dashboard: deal.dashboard
      };
      if (idx >= 0) {
        deals[idx] = payload;
      } else {
        deals.push(payload);
      }
      saveDealsToStorage(deals);
    }

    function deleteDealFromStorage(id) {
      const deals = loadDealsFromStorage();
      const filtered = deals.filter(d => d.id !== id);
      saveDealsToStorage(filtered);
    }

    // --- Admin ---
    function renderAdminList() {
      const container = $("#adminList");
      const deals = loadDealsFromStorage();
      container.innerHTML = "";
      if (deals.length === 0) {
        const div = document.createElement("div");
        div.className = "admin-empty";
        div.textContent = "ì €ì¥ëœ Dealì´ ì—†ìŠµë‹ˆë‹¤.";
        container.appendChild(div);
        return;
      }

      deals
        .sort((a, b) => (b.createdAt || "").localeCompare(a.createdAt || ""))
        .forEach(deal => {
          const row = document.createElement("div");
          row.className = "admin-row";

          const main = document.createElement("div");
          main.className = "admin-main";
          const nameEl = document.createElement("div");
          nameEl.className = "admin-name";
          nameEl.textContent = deal.meta?.name || "(ì´ë¦„ ì—†ìŒ)";
          const descEl = document.createElement("div");
          descEl.className = "admin-desc";
          descEl.textContent = deal.meta?.description || "(ì„¤ëª… ì—†ìŒ)";
          main.appendChild(nameEl);
          main.appendChild(descEl);

          const dateEl = document.createElement("div");
          dateEl.className = "admin-date";
          const dt = deal.createdAt ? new Date(deal.createdAt) : null;
          dateEl.textContent = dt ? dt.toLocaleString() : "-";

          const actions = document.createElement("div");
          actions.className = "admin-actions";

          const loadBtn = document.createElement("button");
          loadBtn.className = "btn-secondary";
          loadBtn.textContent = "ë¶ˆëŸ¬ì˜¤ê¸°";
          loadBtn.addEventListener("click", () => {
            loadDealIntoUI(deal);
            // switch tab to qualification
            const tabButtons = $all(".tab-button");
            tabButtons.forEach(b => {
              const isQual = b.dataset.tab === "qualification";
              b.classList.toggle("active", isQual);
              b.setAttribute("aria-selected", isQual ? "true" : "false");
            });
            showElement($("#tab-qualification"));
            hideElement($("#tab-admin"));
          });

          const delBtn = document.createElement("button");
          delBtn.className = "btn-danger";
          delBtn.textContent = "ì‚­ì œ";
          delBtn.addEventListener("click", () => {
            if (confirm("ì´ Dealì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
              deleteDealFromStorage(deal.id);
              // If currently loaded deal is this one, reset
              if (currentDeal && currentDeal.id === deal.id) {
                currentDeal = null;
                resetUIForNewDeal();
              }
              renderAdminList();
            }
          });

          actions.appendChild(loadBtn);
          actions.appendChild(delBtn);

          row.appendChild(main);
          row.appendChild(dateEl);
          row.appendChild(actions);

          container.appendChild(row);
        });
    }

    function resetUIForNewDeal() {
      $("#dealNameInput").value = "";
      $("#dealDescriptionInput").value = "";
      hideElement($("#dealWinSection"));
      hideElement($("#techFitSection"));
      hideElement($("#dashboardSection"));
      hideElement($("#dealWinSummaryBar"));
      hideElement($("#techFitSummaryBar"));
      hideElement($("#dealWinResultArea"));
      hideElement($("#techFitResultArea"));

      // reset selects
      $all("select[data-dw-score], select[data-tf-score]").forEach(sel => {
        sel.value = "";
      });

      // reset results
      $("#dealScoreValue").textContent = "-";
      $("#winProbValue").textContent = "-";
      $("#dealWinRiskList").innerHTML = "";
      $("#techScoreValue").textContent = "-";
      $("#techRiskValue").textContent = "-";
      $("#techFitRiskList").innerHTML = "";
      $("#metricDealScore").textContent = "-";
      $("#metricWinProb").textContent = "-";
      $("#metricTechScore").textContent = "-";
      $("#metricTechRisk").textContent = "-";
      $("#summaryZone").textContent = "-";
      $("#summaryBody").textContent = "Deal ì ìˆ˜ì— ê¸°ë°˜í•œ ì´í‰ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.";
      $("#summaryActions").textContent = "ê¶Œì¥ ì•¡ì…˜ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.";
    }

    function loadDealIntoUI(deal) {
      currentDeal = JSON.parse(JSON.stringify(deal)); // deep-ish copy

      resetUIForNewDeal();

      // Deal info
      $("#dealNameInput").value = currentDeal.meta?.name || "";
      $("#dealDescriptionInput").value = currentDeal.meta?.description || "";
      showElement($("#dealInfoSection"));
      showElement($("#dealWinSection"));
      showElement($("#techFitSection"));
      showElement($("#dashboardSection"));

      // Deal Win
      if (currentDeal.dealWin) {
        const dw = currentDeal.dealWin;
        // scores
        const s = dw.scores || {};
        Object.entries(s).forEach(([key, val]) => {
          const sel = document.querySelector(`[data-dw-score="${key}"]`);
          if (sel) sel.value = String(val);
        });
        // weights
        if (dw.weights) {
          $("#dwWeightBudget").value = dw.weights.wB;
          $("#dwWeightNeed").value = dw.weights.wN;
          $("#dwWeightAuthority").value = dw.weights.wA;
          $("#dwWeightTimeline").value = dw.weights.wT;
          updateWeightSum("dw");
        }
        renderDealWinResult(dw);
      }

      // Tech Fit
      if (currentDeal.techFit) {
        const tf = currentDeal.techFit;
        const s = tf.scores || {};
        Object.entries(s).forEach(([key, val]) => {
          const sel = document.querySelector(`[data-tf-score="${key}"]`);
          if (sel) sel.value = String(val);
        });
        if (tf.weights) {
          $("#tfWeightTechnicalFit").value = tf.weights.wt;
          $("#tfWeightEnvironment").value = tf.weights.we;
          $("#tfWeightCompliance").value = tf.weights.wc;
          $("#tfWeightHuman").value = tf.weights.wh;
          updateWeightSum("tf");
        }
        renderTechFitResult(tf);
      }

      // Dashboard
      renderDashboard();
    }

    // --- Init ---
    document.addEventListener("DOMContentLoaded", () => {
      initTabs();
      initDealInfo();
      initTooltips();
      initWeightInputs();
      initModal();
      initCollapse();
      initDealWin();
      initTechFit();
      renderAdminList();

      // Start ìƒíƒœì—ì„œ ë°”ë¡œ Deal Info ì—´ë„ë¡ í•  ìˆ˜ë„ ìˆìŒ
    });
  </script>
</body>
</html>
